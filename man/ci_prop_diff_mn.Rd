% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prop_ci_mn.R
\name{ci_prop_diff_mn}
\alias{ci_prop_diff_mn}
\title{Miettinen-Nurminen Confidence Interval for Difference in Proportions}
\usage{
ci_prop_diff_mn(x, y, conf.level = 0.95)
}
\arguments{
\item{x}{A binary vector representing the first sample.}

\item{y}{A binary vector representing the second sample.}

\item{conf.level}{A numeric value between 0 and 1 specifying the confidence level.
Default is 0.95 (95\% confidence).}
}
\value{
A list containing the following components:
  \item{estimate}{The point estimate of the difference in proportions (p_x - p_y)}
  \item{conf.low}{Lower bound of the confidence interval}
  \item{conf.high}{Upper bound of the confidence interval}
  \item{conf.level}{The confidence level used}
  \item{method}{Description of the method used ("Miettinen-Nurminen Confidence Interval")}
}
\description{
Calculates the Miettinen-Nurminen (MN) confidence interval for the difference
between two proportions. This method can be more accurate than traditional methods,
especially with small sample sizes or proportions close to 0 or 1.
}
\details{
The function implements the Miettinen-Nurminen method to compute confidence intervals
for the difference between two proportions. This approach:

1. Computes the test statistic across a range of possible difference values (delta)
2. Identifies values of delta where the test statistic falls within the critical region
   determined by the confidence level
3. Returns the minimum and maximum acceptable values as the confidence interval bounds

The method uses a score test with a small-sample correction factor, making it more
accurate than normal approximation methods, especially for small samples or extreme proportions.
The equation for the test statistics is as follows:
\deqn{T_{MN} = \frac{\hat{p}_x - \hat{p}_y - \delta}{\sqrt{V_{\delta}}}}

where:
\itemize{
  \item \eqn{\hat{p}_x} and \eqn{\hat{p}_y} are the observed proportions in the two groups
  \item \eqn{\delta} is the hypothesized difference
  \item \eqn{V_{\delta}} is the variance estimate under the null hypothesis
        \eqn{V_{\delta} = \lambda(\tilde{p}_x(1-\tilde{p}_x)/n_x + \tilde{p}_y(1-\tilde{p}_y)/n_y)}
  \item \eqn{\lambda = N/(N+1)} is a small sample correction factor
  \item \eqn{\tilde{p}_x} and \eqn{\tilde{p}_y} are the restricted maximum likelihood estimates
        under the constraint that \eqn{\tilde{p}_x - \tilde{p}_y = \delta}
  \item \eqn{\tilde{p}_x = 2ucos(w) - b/3a} and  \eqn{\tilde{p}_y = \tilde{p}_x - \delta}
  \item \eqn{w = \frac{\pi + cos^{-1}(v/u^3)}{3}}
  \item \eqn{v = \frac{b^3}{27a^3}-\frac{bc}{6a^2}+\frac{d}{2a}}
  \item \eqn{u = \frac{v}{|v|}\sqrt{\frac{b^2}{9a^2}+\frac{c}{3a}}}
  \item \eqn{a = 1 + \theta}
  \item \eqn{b = -(1 + \theta + \tilde{p}_x + \theta\tilde{p}_y + \delta(\theta + 2))}
  \item \eqn{c = \delta^2 + \delta(2\tilde{p}_x + \theta + 1) + \tilde{p}_x + \theta\tilde{p}_y}
  \item \eqn{d = -\tilde{p}_x\delta(1+\delta)}
  \item \eqn{\theta = n_y / n_x}

}
}
\examples{
# Generate two binary samples
x <- rbinom(100, 1, 0.6)
y <- rbinom(80, 1, 0.5)

# Calculate 95\% confidence interval for difference in proportions
ci_prop_diff_mn(x, y)

# Calculate 99\% confidence interval
ci_prop_diff_mn(x, y, conf.level = 0.99)

}
\references{
Miettinen, O. S., & Nurminen, M. (1985). Comparative analysis of two rates.
Statistics in Medicine, 4(2), 213-226.

Chen, Y., & Zhou, X. (2016). Interval Estimation for the Difference Between
Independent Proportions. Western Users of SAS Software Conference Proceedings 2016.
https://www.lexjansen.com/wuss/2016/127_Final_Paper_PDF.pdf
}
